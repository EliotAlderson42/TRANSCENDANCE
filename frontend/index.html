<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transcendance</title>

<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/audioMenu.css">
<link rel="stylesheet" href="css/settingsMenu.css">
<link rel="stylesheet" href="css/languageMenu.css">
<link rel="stylesheet" href="css/mainMenu.css">
<link rel="stylesheet" href="css/accountMenu.css">
<link rel="stylesheet" href="css/accountSettingsMenu.css">
<link rel="stylesheet" href="css/historyMenu.css">
<link rel="stylesheet" href="css/statsMenu.css">

</head>
</html>

<body>
    <script src = "/js/switchLanguage.js"> </script>
    <script src = "/js/containers.js"> </script>
    <script src = "/js/mainMenu.js"> </script>
    <script src = "/js/authenticationMenu.js"> </script>
    <script src = "/js/authenticationMenu/signInMenu.js"> </script>
    <script src = "/js/authenticationMenu/signUpMenu.js"> </script>
    <script src = "/js/settingsMenu/audioMenu.js"> </script>
    <script src = "/js/settingsMenu.js"> </script>
    <script src = "/js/settingsMenu/languageMenu.js"> </script>
    <script src = "/js/settingsMenu/accountMenu.js"> </script>
    <script src = "/js/playMenu.js"> </script>
    <script src = "/js/playMenu/localMenu.js"> </script>
    <script src = "/js/playMenu/onlineMenu.js"> </script>
    <script src = "/js/playMenu/friendsMenu.js"> </script>
    <script src = "/js/auth.js"></script>
    <script src = "/js/userStatus.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <audio id="backgroundAudio" loop>
        <source src="audio/bgMusic.mp3" type="audio/mpeg">
    </audio>
    <audio id="pongAudio">
        <source src="audio/PONG.mp3" type="audio/mpeg">
    </audio>
    <audio id="hoverSound">
        <source src="audio/Hover.mp3" type="audio/mpeg">
    </audio>
    <audio id="clickIn">
        <source src="audio/lambdaButtonIn.mp3" type="audio/mpeg">
    </audio>
    <audio id="clickOut">
        <source src="audio/lambdaButtonOut.mp3" type="audio/mpeg">
    </audio>
    <div id="dynamicContent"></div>

    <script>
        function playAudio(audioId){
            const audio = document.getElementById(audioId);
            if (audio)
                audio.play();
        }
        function switchAudio(audioId){
            const audio = document.getElementById(audioId);
            if (audio)
                audio.muted ? audio.muted = false : audio.muted = true;
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Vérifier l'authentification au chargement
            if (window.location.hash.startsWith('#auth=')) {
                const authData = JSON.parse(decodeURIComponent(window.location.hash.substring(6)));
                if (authData.isLoggedIn) {
                    localStorage.setItem('user', JSON.stringify(authData));
                    window.location.hash = '';
                    mainMenu.show();  // Rediriger vers le menu principal
                    return;
                }
            }
            initialPage.show();  // Sinon, afficher la page initiale
        });

        document.addEventListener('DOMContentLoaded', () => {
            window.userStatusManager = new UserStatusManager();
        });

        // Dans mainMenu.js ou similaire
        if (document.referrer.includes('/auth/42/callback')) {
            checkAuthStatus();  // Vérifie immédiatement l'état de connexion après redirection
        }
    </script>

</body>
</html>

